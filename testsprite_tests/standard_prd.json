{
  "meta": {
    "project": "Baby Diary (우리 아기 일기)",
    "date": "2026-02-19",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Baby Diary is a PWA for parents to record baby growth moments with photo-rich diary entries and for family to read and comment. Admin users can create, edit, delete, and export entries while visitors can browse and comment (when logged in).",
  "core_goals": [
    "Provide a warm, family-friendly interface to create and browse photo diary entries.",
    "Allow authenticated admin users to create, edit, delete, and export diary entries (PDF).",
    "Enable family members to browse entries and leave comments with simple authentication.",
    "Deliver a responsive PWA with good performance, Korean language support, and accessible photo lightbox navigation."
  ],
  "features": [
    {
      "name": "Home Page",
      "description": "Landing page showing hero section, a grid of recent diary entries, and a list of recent comments with a CTA to the diary list.",
      "user_flows": [
        "Navigate to / -> View hero section with baby image -> Browse recent diary entry cards -> Click diary entry card to view detail -> See diary detail at /diary?date=YYYY-MM-DD",
        "Navigate to / -> Click \"일기 보러가기\" button -> See diary list at /diary",
        "Navigate to / -> Browse recent comments -> Recent entries fail to load from backend -> See error message about data load failure"
      ]
    },
    {
      "name": "User Login",
      "description": "Authentication using Google OAuth or email/password with sign-up flow and role-based admin determination.",
      "user_flows": [
        "Navigate to /login -> Click Google login button -> Complete OAuth provider flow -> Redirect to / -> See logged-in state",
        "Navigate to /login -> Toggle between login and sign-up mode -> Fill name field (sign-up) -> Fill email input field -> Fill password input field (>=6 chars) -> Click login button to submit -> Redirect to / -> See logged-in state",
        "Navigate to /login -> Fill email input field -> Fill password input field (incorrect) -> Click login button to submit -> See error message on invalid credentials",
        "Navigate to /login -> Toggle to sign-up mode -> Fill name field -> Fill email input field -> Fill password input field (less than 6 chars) -> Click login button to submit -> See validation error about password length"
      ]
    },
    {
      "name": "Diary List",
      "description": "Paginated list of diary entries grouped by month with infinite scroll and '더 보기' for loading more entries.",
      "user_flows": [
        "Navigate to /diary -> Browse diary entries grouped by month -> Click entry to view diary detail -> See diary detail at /diary?date=YYYY-MM-DD",
        "Navigate to /diary -> Click \"더 보기\" button -> See additional entries load (next page)",
        "Navigate to /diary -> See empty state (no entries) -> Click link to write first diary -> If admin, navigate to /write; if not admin, see prompt to log in or unauthorized message"
      ]
    },
    {
      "name": "Diary Detail",
      "description": "Show a single diary entry with full content, photo gallery + lightbox, comment section, and admin controls (edit/delete).",
      "user_flows": [
        "Navigate to /diary?date=YYYY-MM-DD -> View diary date, title, and content -> Click photos to open lightbox -> Navigate photos with arrows or swipe -> Close lightbox with ESC -> Read comments",
        "Navigate to /diary?date=YYYY-MM-DD -> Read comments -> Click post comment -> If logged-in, fill comment -> Submit comment -> See new comment appear",
        "Navigate to /diary?date=YYYY-MM-DD -> If admin, see Edit and Delete buttons -> Click Edit -> Navigate to /write?date=YYYY-MM-DD -> See pre-filled form",
        "Navigate to /diary?date=YYYY-MM-DD -> Click Delete -> Confirm deletion -> Backend delete fails (Firebase error) -> See deletion error message",
        "Navigate to /diary?date=YYYY-MM-DD -> Attempt to post comment while not logged in -> Click post comment -> See prompt to log in"
      ]
    },
    {
      "name": "Write New Diary",
      "description": "Admin-only form to create a new diary entry with date, optional title, up to 10 photos (with editor), and content.",
      "user_flows": [
        "Navigate to /write -> Select date (defaults to today) -> Enter title (optional) -> Upload photos (max 10) -> Edit/decorate photos with built-in editor -> Remove photos (optional) -> Write content text -> Click Submit -> Entry saved to backend -> Redirect to /diary?date=YYYY-MM-DD",
        "Navigate to /write -> Upload 11th photo -> See validation error about max 10 photos",
        "Navigate to /write -> Select date that already has an entry -> Fill required content -> Click Submit -> See duplicate date validation error and prevent save",
        "Navigate to /write -> Non-admin user accesses route -> See access denied or redirect to /login"
      ]
    },
    {
      "name": "Edit Diary",
      "description": "Admin-only edit form that pre-fills existing diary data and allows updating text and managing photos.",
      "user_flows": [
        "Navigate to /write?date=YYYY-MM-DD -> See pre-filled form with existing diary data -> Modify title and content -> Add or remove photos -> Edit photos with built-in editor -> Click Submit -> Update entry saved to backend -> Redirect to /diary?date=YYYY-MM-DD",
        "Navigate to /write?date=YYYY-MM-DD -> Remove existing photo -> Confirm removal -> Backend storage deletion fails -> See photo deletion error message",
        "Navigate to /write?date=YYYY-MM-DD -> Non-admin user attempts access -> See access denied or redirect to /login"
      ]
    },
    {
      "name": "PDF Export",
      "description": "Admin-only export that generates a styled A5 PDF (Korean font support) for a selected date range with progress feedback.",
      "user_flows": [
        "Navigate to /export -> Select start date -> Select end date (start <= end) -> Click PDF download button -> See progress bar during generation -> Download file named 육아일기_{startDate}_{endDate}.pdf",
        "Navigate to /export -> Leave start or end date empty -> Click PDF download button -> See validation error requiring both dates",
        "Navigate to /export -> Select start date later than end date -> Click PDF download button -> See validation error about date range",
        "Navigate to /export -> Click PDF download button -> Backend or generation fails (Firebase or PDF library error) -> See generation error message"
      ]
    },
    {
      "name": "Navigation",
      "description": "Responsive header with desktop nav links and mobile hamburger menu; dynamic links based on auth state.",
      "user_flows": [
        "On any page -> Click logo in header -> Navigate to /",
        "On desktop -> Click diary list link in header -> Navigate to /diary",
        "On mobile -> Click hamburger menu -> Open mobile menu overlay -> Click navigation link (e.g., 글쓰기) -> If admin navigate to /write; if not admin, see unauthorized or redirect to /login",
        "On any page -> Click Login link when not logged in -> Navigate to /login -> After login see header update to logged-in links",
        "On any page -> Click Logout when logged in -> See logged-out state in header"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "Next.js 16 (App Router)",
      "React 19",
      "Tailwind CSS 4",
      "Firebase (Auth, Firestore, Storage)"
    ],
    "routes": [
      {
        "path": "/",
        "file": "src/app/page.tsx",
        "auth_required": false,
        "description": "Home page with hero section, recent diary entries and recent comments"
      },
      {
        "path": "/login",
        "file": "src/app/login/page.tsx",
        "auth_required": false,
        "description": "Login page with Google OAuth and email/password authentication"
      },
      {
        "path": "/diary",
        "file": "src/app/diary/page.tsx",
        "auth_required": false,
        "description": "Diary list page with paginated entries grouped by month"
      },
      {
        "path": "/diary?date=YYYY-MM-DD",
        "file": "src/app/diary/page.tsx",
        "auth_required": false,
        "description": "Diary detail page showing a single entry with photos, content, and comments"
      },
      {
        "path": "/write",
        "file": "src/app/write/page.tsx",
        "auth_required": true,
        "description": "New diary entry creation form (admin only)"
      },
      {
        "path": "/write?date=YYYY-MM-DD",
        "file": "src/app/write/page.tsx",
        "auth_required": true,
        "description": "Edit existing diary entry form (admin only)"
      },
      {
        "path": "/export",
        "file": "src/app/export/page.tsx",
        "auth_required": true,
        "description": "PDF export page for diary entries in date range (admin only)"
      }
    ],
    "features": [
      {
        "name": "Home Page",
        "description": "Landing page with hero image, recent diary entries grid, and recent comments list",
        "files": [
          "src/app/page.tsx",
          "src/components/Header.tsx",
          "src/components/Footer.tsx"
        ],
        "entry_route": "/",
        "user_interactions": [
          "View hero section with baby image",
          "Browse recent diary entry cards",
          "Browse recent comments",
          "Click diary entry card to view detail",
          "Click \"일기 보러가기\" button to go to diary list"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getRecentEntries(6)"
          },
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getRecentComments(10)"
          }
        ],
        "auth_required": false
      },
      {
        "name": "User Login",
        "description": "Login with Google OAuth or email/password credentials, with sign-up option",
        "files": [
          "src/app/login/page.tsx",
          "src/lib/firebase/auth.ts",
          "src/components/AuthProvider.tsx"
        ],
        "entry_route": "/login",
        "user_interactions": [
          "Click Google login button",
          "Fill email input field",
          "Fill password input field",
          "Click login button to submit",
          "Toggle between login and sign-up mode",
          "Fill name field (sign-up mode only)",
          "See error message on invalid credentials"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "Firebase Auth signInWithGoogle"
          },
          {
            "method": "POST",
            "endpoint": "Firebase Auth signInWithEmail"
          },
          {
            "method": "POST",
            "endpoint": "Firebase Auth signUpWithEmail"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Diary List",
        "description": "Paginated list of diary entries grouped by month with infinite scroll",
        "files": [
          "src/app/diary/page.tsx",
          "src/components/DiaryList.tsx"
        ],
        "entry_route": "/diary",
        "user_interactions": [
          "Browse diary entries grouped by month",
          "Click entry to view diary detail",
          "Click \"더 보기\" button to load more entries",
          "See empty state with link to write first diary"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getEntriesPage(20)"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Diary Detail",
        "description": "View a single diary entry with photos gallery, lightbox, content, admin controls, and comments",
        "files": [
          "src/app/diary/page.tsx",
          "src/components/DiaryDetail.tsx",
          "src/components/CommentSection.tsx"
        ],
        "entry_route": "/diary?date=YYYY-MM-DD",
        "user_interactions": [
          "View diary date, title, and content",
          "Click photos to open lightbox",
          "Navigate photos with arrows or swipe in lightbox",
          "Close lightbox with ESC or X button",
          "Read and post comments (logged-in users)",
          "Edit diary entry (admin only)",
          "Delete diary entry (admin only)",
          "Click \"목록으로\" to go back to diary list"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getEntry(date)"
          },
          {
            "method": "DELETE",
            "endpoint": "Firebase Firestore deleteEntry(date)"
          },
          {
            "method": "DELETE",
            "endpoint": "Firebase Storage deletePhoto(path)"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Write New Diary",
        "description": "Create new diary entry with date, title, photos (up to 10), photo editor, and content",
        "files": [
          "src/app/write/page.tsx",
          "src/components/WriteNewForm.tsx",
          "src/components/PhotoEditor.tsx"
        ],
        "entry_route": "/write",
        "user_interactions": [
          "Select date",
          "Enter title (optional)",
          "Upload photos (max 10)",
          "Edit/decorate photos with built-in editor",
          "Remove photos",
          "Write content text",
          "Submit form to save diary",
          "Cancel to go back"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "Firebase Firestore createEntry"
          },
          {
            "method": "POST",
            "endpoint": "Firebase Storage uploadPhoto"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Edit Diary",
        "description": "Edit existing diary entry content and manage photos",
        "files": [
          "src/app/write/page.tsx",
          "src/components/WriteEditForm.tsx",
          "src/components/PhotoEditor.tsx"
        ],
        "entry_route": "/write?date=YYYY-MM-DD",
        "user_interactions": [
          "View pre-filled form with existing diary data",
          "Modify title, content",
          "Add or remove photos",
          "Edit photos with built-in editor",
          "Submit form to update diary",
          "Cancel to go back"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getEntry(date)"
          },
          {
            "method": "PUT",
            "endpoint": "Firebase Firestore updateEntry"
          },
          {
            "method": "POST",
            "endpoint": "Firebase Storage uploadPhoto"
          },
          {
            "method": "DELETE",
            "endpoint": "Firebase Storage deletePhoto"
          }
        ],
        "auth_required": true
      },
      {
        "name": "PDF Export",
        "description": "Export diary entries in a date range to a styled A5 PDF with Korean font support",
        "files": [
          "src/app/export/page.tsx"
        ],
        "entry_route": "/export",
        "user_interactions": [
          "Select start date",
          "Select end date",
          "Click PDF download button",
          "View progress bar during generation",
          "See error messages for validation or generation failures"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "Firebase Firestore getEntriesInRange(startDate, endDate)"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Navigation",
        "description": "Responsive header with desktop nav and mobile hamburger menu",
        "files": [
          "src/components/Header.tsx"
        ],
        "entry_route": "/",
        "user_interactions": [
          "Click logo to go to home",
          "Click navigation links (diary list, write, export)",
          "Open/close mobile menu",
          "Login/logout"
        ],
        "api_calls": [],
        "auth_required": false
      }
    ],
    "known_limitations": [
      {
        "issue": "Firebase backend requires valid credentials; tests without Firebase config will see connection errors",
        "location": "src/lib/firebase/config.ts",
        "impact": "All data-fetching features depend on Firebase connectivity"
      },
      {
        "issue": "Admin features (write, edit, delete, export) are restricted by ADMIN_EMAILS environment variable",
        "location": "src/lib/types.ts",
        "impact": "Non-admin users cannot access write/edit/delete/export features"
      }
    ]
  }
}
